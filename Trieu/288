ksql>
>CREATE TABLE customers_tbl (
>    id INT PRIMARY KEY,
>    name VARCHAR,
>    email VARCHAR
>) WITH (
>    KAFKA_TOPIC='mysql.shopdb.customers',
>    VALUE_FORMAT='JSON'
>);
>
>CREATE TABLE orders_tbl (
>    id INT PRIMARY KEY,
>    customer_id INT,
>    product VARCHAR,
>    amount DECIMAL(10,2)
>) WITH (
>    KAFKA_TOPIC='mysql.shopdb.orders',
>    VALUE_FORMAT='JSON'
>);

CREATE TABLE CUSTOMERS_TBL (ID INTEGER PRIMARY KEY, NAME STRING, EMAIL STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='mysql.shopdb.customers', KEY_FORMAT='KAFKA', VALUE_FORMAT='JSON');
 Message
---------------
 Table created
---------------

CREATE TABLE ORDERS_TBL (ID INTEGER PRIMARY KEY, CUSTOMER_ID INTEGER, PRODUCT STRING, AMOUNT DECIMAL(10, 2)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='mysql.shopdb.orders', KEY_FORMAT='KAFKA', VALUE_FORMAT='JSON');
 Message
---------------
 Table created
---------------
ksql> CREATE TABLE orders_joined AS
>SELECT o.id AS order_id,
>       o.product AS product,
>       o.amount AS amount,
>       c.name AS customer_name,
>       c.email AS customer_email
>FROM orders_tbl o
>LEFT JOIN customers_tbl c
>ON o.customer_id = c.id;

 Message
---------------------------------------------
 Created query with ID CTAS_ORDERS_JOINED_29
---------------------------------------------
ksql> SELECT * FROM orders_joined EMIT CHANGES;
+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+
|ORDER_ID                               |PRODUCT                                |AMOUNT                                 |CUSTOMER_NAME                          |CUSTOMER_EMAIL                         |
+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+

